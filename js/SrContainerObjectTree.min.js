document.addEventListener("DOMContentLoaded",()=>{class a{constructor({container_ref_id:a,el:b,empty_text:c,error_text:d,fetch_url:e}){this.container_ref_id=a,this.el=b,this.empty_text=c,this.error_text=d,this.fetch_url=e}async clickNode({arrow_el:a,children_el:b,ref_id:c}){a.classList.toggle("SrContainerObjectTreeArrowOpen"),0===b.children.length&&(await this.fetchTree({parent_el:b,parent_ref_id:c}))}async fetchTree({parent_el:a,parent_ref_id:b}){const c=document.createElement("div");c.classList.add("SrContainerObjectTreeLoading"),a.appendChild(c);let d;try{d=await(await fetch(`${this.fetch_url}${b}`,{headers:{accept:"application/js","content-type":"application/js"}})).json()}catch(b){console.error(b);const c=document.createElement("div");return c.classList.add("SrContainerObjectTreeError"),c.innerText=this.error_text,void a.appendChild(c)}finally{a.removeChild(c)}if(0<d.length)for(const{icon:b,is_container:c,link:e,ref_id:f,title:g}of d){const d=document.createElement("div");d.classList.add("SrContainerObjectTreeNode");const h=document.createElement("div");if(h.classList.add("SrContainerObjectTreeChildren"),c){const a=document.createElement("div");a.classList.add("SrContainerObjectTreeArrow"),a.addEventListener("click",this.clickNode.bind(this,{arrow_el:a,children_el:h,ref_id:f})),d.appendChild(a)}const i=document.createElement("a");i.classList.add("SrContainerObjectTreeLink"),i.href=e;const j=document.createElement("img");j.classList.add("SrContainerObjectTreeIcon"),j.src=b,i.appendChild(j);const k=document.createElement("div");k.classList.add("SrContainerObjectTreeTitle"),k.innerText=g,i.appendChild(k),d.appendChild(i),c&&d.appendChild(h),a.appendChild(d)}else{const b=document.createElement("div");b.classList.add("SrContainerObjectTreeEmpty"),b.innerText=this.empty_text,a.appendChild(b)}}async init(){await this.fetchTree({parent_el:this.el,parent_ref_id:this.container_ref_id})}}for(const b of document.querySelectorAll(".SrContainerObjectTree")){const c=JSON.parse(atob(b.dataset.srcontainerobjecttree));c.el=b;const d=new a(c);d.init()}});
