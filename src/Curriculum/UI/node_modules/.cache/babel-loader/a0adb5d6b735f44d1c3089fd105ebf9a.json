{"ast":null,"code":"import _toConsumableArray from\"/home/mstuder/Develop/ILIAS/medi/ilias/Customizing/global/plugins/Services/UIComponent/UserInterfaceHook/SrCurriculum/src/Curriculum/Infrastructure/UI/tree/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";import _classCallCheck from\"/home/mstuder/Develop/ILIAS/medi/ilias/Customizing/global/plugins/Services/UIComponent/UserInterfaceHook/SrCurriculum/src/Curriculum/Infrastructure/UI/tree/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"/home/mstuder/Develop/ILIAS/medi/ilias/Customizing/global/plugins/Services/UIComponent/UserInterfaceHook/SrCurriculum/src/Curriculum/Infrastructure/UI/tree/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";import _inherits from\"/home/mstuder/Develop/ILIAS/medi/ilias/Customizing/global/plugins/Services/UIComponent/UserInterfaceHook/SrCurriculum/src/Curriculum/Infrastructure/UI/tree/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";import _createSuper from\"/home/mstuder/Develop/ILIAS/medi/ilias/Customizing/global/plugins/Services/UIComponent/UserInterfaceHook/SrCurriculum/src/Curriculum/Infrastructure/UI/tree/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createSuper\";import React from'react';import'./styles.css';import Tree from'@naisutech/react-tree';var CurriculumTree=/*#__PURE__*/function(_React$Component){_inherits(CurriculumTree,_React$Component);var _super=_createSuper(CurriculumTree);function CurriculumTree(props){var _this;_classCallCheck(this,CurriculumTree);_this=_super.call(this,props);_this.onSelect=function(selectedNode){if(selectedNode.type=='cat'){_this.onSelectilCategory(selectedNode);}else{_this.onSelectilItem(selectedNode);}};_this.state={urlTreeService:document.getElementById('treeservice').textContent,nodeIdToLoad:document.getElementById('treeservice-nodeid').textContent,nodeDepthToLoad:1,loadedTreeNodeIds:[],nodesOfTree:[],alreadyinTree:[],showLoadingSpinner:1};_this.loadTreeSection(_this.state.nodeIdToLoad,_this.state.nodeDepthToLoad,_this.state.loadedTreeNodeIds,_this.state.nodesOfTree,_this.state.alreadyinTree);return _this;}_createClass(CurriculumTree,[{key:\"loadTreeSection\",value:function loadTreeSection(nodeIdToLoad,nodeDepthToLoad,loadedTreeNodeIds,nodesOfTree,alreadyinTree){var _this2=this;var params=new URLSearchParams();params.append('node_id',nodeIdToLoad);params.append('node_depth',nodeDepthToLoad);fetch(this.state.urlTreeService+\"&\"+params).then(function(res){return res.json();}).then(function(json){var tree_node;for(var i=0;i<json.length;i++){tree_node=json[i];console.log(tree_node.id);if(_this2.checkIfLoaded(alreadyinTree,tree_node.id)===false){console.log('LOAD');_this2.state.nodesOfTree.push(tree_node);_this2.state.alreadyinTree.push(tree_node.id);}}_this2.setState({loadedTreeNodeIds:[].concat(_toConsumableArray(_this2.state.loadedTreeNodeIds),[nodeIdToLoad]),nodesOfTree:_this2.state.nodesOfTree,alreadyinTree:_this2.state.alreadyinTree,showLoadingSpinner:''});});}},{key:\"onSelectilCategory\",value:function onSelectilCategory(selectedCategoryNode){var _this$state=this.state,urlTreeService=_this$state.urlTreeService,nodeIdToLoad=_this$state.nodeIdToLoad,nodeDepthToLoad=_this$state.nodeDepthToLoad,loadedTreeNodeIds=_this$state.loadedTreeNodeIds,nodesOfTree=_this$state.nodesOfTree,alreadyinTree=_this$state.alreadyinTree,showLoadingSpinner=_this$state.showLoadingSpinner;if(this.checkIfLoaded(loadedTreeNodeIds,selectedCategoryNode.id)===false){this.setState({showLoadingSpinner:1});this.loadTreeSection(selectedCategoryNode.id,selectedCategoryNode.depth,loadedTreeNodeIds,nodesOfTree,alreadyinTree);}}},{key:\"onSelectilItem\",value:function onSelectilItem(selectedItemNode){var _this$state2=this.state,urlTreeService=_this$state2.urlTreeService,nodeIdToLoad=_this$state2.nodeIdToLoad,nodeDepthToLoad=_this$state2.nodeDepthToLoad,loadedTreeNodeIds=_this$state2.loadedTreeNodeIds,nodesOfTree=_this$state2.nodesOfTree,alreadyinTree=_this$state2.alreadyinTree,showLoadingSpinner=_this$state2.showLoadingSpinner;console.log(selectedItemNode.link);this.setState({showLoadingSpinner:1});window.location.href=selectedItemNode.link;}},{key:\"render\",value:function render(){var _this$state3=this.state,urlTreeService=_this$state3.urlTreeService,nodeIdToLoad=_this$state3.nodeIdToLoad,nodeDepthToLoad=_this$state3.nodeDepthToLoad,loadedTreeNodeIds=_this$state3.loadedTreeNodeIds,nodesOfTree=_this$state3.nodesOfTree,showLoadingSpinner=_this$state3.showLoadingSpinner;return/*#__PURE__*/React.createElement(\"div\",{className:\"showtree\",style:{display:'flex',flexWrap:'nowrap',flexGrow:1}},/*#__PURE__*/React.createElement(\"div\",{style:{display:'flex',flexWrap:'nowrap',flexGrow:1}},/*#__PURE__*/React.createElement(Tree,{nodes:nodesOfTree,theme:'light',onSelect:this.onSelect,isLoading:showLoadingSpinner})));}},{key:\"checkIfLoaded\",value:function checkIfLoaded(loadedTreeNodeIds,nodeIdToLoad){return loadedTreeNodeIds.indexOf(nodeIdToLoad)>=0;}}]);return CurriculumTree;}(React.Component);export default CurriculumTree;","map":{"version":3,"sources":["/home/mstuder/Develop/ILIAS/medi/ilias/Customizing/global/plugins/Services/UIComponent/UserInterfaceHook/SrCurriculum/src/Curriculum/Infrastructure/UI/tree/src/CurriculumTree.js"],"names":["React","Tree","CurriculumTree","props","onSelect","selectedNode","type","onSelectilCategory","onSelectilItem","state","urlTreeService","document","getElementById","textContent","nodeIdToLoad","nodeDepthToLoad","loadedTreeNodeIds","nodesOfTree","alreadyinTree","showLoadingSpinner","loadTreeSection","params","URLSearchParams","append","fetch","then","res","json","tree_node","i","length","console","log","id","checkIfLoaded","push","setState","selectedCategoryNode","depth","selectedItemNode","link","window","location","href","display","flexWrap","flexGrow","indexOf","Component"],"mappings":"k1CAAA,MAAOA,CAAAA,KAAP,KAAkB,OAAlB,CAEA,MAAO,cAAP,CACA,MAAOC,CAAAA,IAAP,KAAiB,uBAAjB,C,GAEMC,CAAAA,c,4HAEJ,wBAAYC,KAAZ,CAAmB,gDACjB,uBAAMA,KAAN,EADiB,MAuDnBC,QAvDmB,CAuDR,SAACC,YAAD,CAAkB,CAC3B,GAAGA,YAAY,CAACC,IAAb,EAAqB,KAAxB,CAA+B,CAC7B,MAAKC,kBAAL,CAAwBF,YAAxB,EACD,CAFD,IAEO,CACL,MAAKG,cAAL,CAAoBH,YAApB,EACD,CACF,CA7DkB,CAIjB,MAAKI,KAAL,CAAa,CACXC,cAAc,CAAEC,QAAQ,CAACC,cAAT,CAAwB,aAAxB,EAAuCC,WAD5C,CAEXC,YAAY,CAAEH,QAAQ,CAACC,cAAT,CAAwB,oBAAxB,EAA8CC,WAFjD,CAGXE,eAAe,CAAE,CAHN,CAIXC,iBAAiB,CAAE,EAJR,CAKXC,WAAW,CAAE,EALF,CAMXC,aAAa,CAAE,EANJ,CAOXC,kBAAkB,CAAE,CAPT,CAAb,CAUA,MAAKC,eAAL,CACE,MAAKX,KAAL,CAAWK,YADb,CAEE,MAAKL,KAAL,CAAWM,eAFb,CAGE,MAAKN,KAAL,CAAWO,iBAHb,CAIE,MAAKP,KAAL,CAAWQ,WAJb,CAKE,MAAKR,KAAL,CAAWS,aALb,EAdiB,aAoBlB,C,mFAEeJ,Y,CACAC,e,CACAC,iB,CACAC,W,CACAC,a,CAAe,iBAE7B,GAAMG,CAAAA,MAAM,CAAG,GAAIC,CAAAA,eAAJ,EAAf,CACAD,MAAM,CAACE,MAAP,CAAc,SAAd,CAAyBT,YAAzB,EACAO,MAAM,CAACE,MAAP,CAAc,YAAd,CAA4BR,eAA5B,EAEAS,KAAK,CAAC,KAAKf,KAAL,CAAWC,cAAX,CAA4B,GAA5B,CAAkCW,MAAnC,CAAL,CAAgDI,IAAhD,CAAqD,SAAAC,GAAG,QAAIA,CAAAA,GAAG,CAACC,IAAJ,EAAJ,EAAxD,EACCF,IADD,CACM,SAAAE,IAAI,CAAI,CACZ,GAAIC,CAAAA,SAAJ,CACA,IAAI,GAAIC,CAAAA,CAAC,CAAG,CAAZ,CAAeA,CAAC,CAAGF,IAAI,CAACG,MAAxB,CAAgCD,CAAC,EAAjC,CAAqC,CACjCD,SAAS,CAAED,IAAI,CAACE,CAAD,CAAf,CACAE,OAAO,CAACC,GAAR,CAAYJ,SAAS,CAACK,EAAtB,EACF,GAAG,MAAI,CAACC,aAAL,CAAmBhB,aAAnB,CAAkCU,SAAS,CAACK,EAA5C,IAAoD,KAAvD,CAA8D,CAC5DF,OAAO,CAACC,GAAR,CAAY,MAAZ,EACA,MAAI,CAACvB,KAAL,CAAWQ,WAAX,CAAuBkB,IAAvB,CAA4BP,SAA5B,EACA,MAAI,CAACnB,KAAL,CAAWS,aAAX,CAAyBiB,IAAzB,CAA8BP,SAAS,CAACK,EAAxC,EACD,CACF,CAED,MAAI,CAACG,QAAL,CAAc,CACZpB,iBAAiB,8BAAM,MAAI,CAACP,KAAL,CAAWO,iBAAjB,GAAoCF,YAApC,EADL,CAEZG,WAAW,CAAE,MAAI,CAACR,KAAL,CAAWQ,WAFZ,CAGZC,aAAa,CAAE,MAAI,CAACT,KAAL,CAAWS,aAHd,CAIbC,kBAAkB,CAAE,EAJP,CAAd,EAMD,CAnBD,EAoBD,C,8DAWkBkB,oB,CAAsB,iBACqF,KAAK5B,KAD1F,CAC/BC,cAD+B,aAC/BA,cAD+B,CACfI,YADe,aACfA,YADe,CACDC,eADC,aACDA,eADC,CACgBC,iBADhB,aACgBA,iBADhB,CACmCC,WADnC,aACmCA,WADnC,CACgDC,aADhD,aACgDA,aADhD,CAC8DC,kBAD9D,aAC8DA,kBAD9D,CAEvC,GAAI,KAAKe,aAAL,CAAmBlB,iBAAnB,CAAsCqB,oBAAoB,CAACJ,EAA3D,IAAmE,KAAvE,CAA8E,CAC5E,KAAKG,QAAL,CAAc,CAACjB,kBAAkB,CAAE,CAArB,CAAd,EACA,KAAKC,eAAL,CACEiB,oBAAoB,CAACJ,EADvB,CAC2BI,oBAAoB,CAACC,KADhD,CACuDtB,iBADvD,CAC0EC,WAD1E,CACuFC,aADvF,EAED,CACF,C,sDAEcqB,gB,CAAkB,kBAC6F,KAAK9B,KADlG,CACvBC,cADuB,cACvBA,cADuB,CACPI,YADO,cACPA,YADO,CACOC,eADP,cACOA,eADP,CACwBC,iBADxB,cACwBA,iBADxB,CAC2CC,WAD3C,cAC2CA,WAD3C,CACwDC,aADxD,cACwDA,aADxD,CACsEC,kBADtE,cACsEA,kBADtE,CAE/BY,OAAO,CAACC,GAAR,CAAYO,gBAAgB,CAACC,IAA7B,EACA,KAAKJ,QAAL,CAAc,CAACjB,kBAAkB,CAAE,CAArB,CAAd,EACAsB,MAAM,CAACC,QAAP,CAAgBC,IAAhB,CAAuBJ,gBAAgB,CAACC,IAAxC,CACD,C,uCAEQ,kBACuG,KAAK/B,KAD5G,CACCC,cADD,cACCA,cADD,CACiBI,YADjB,cACiBA,YADjB,CAC+BC,eAD/B,cAC+BA,eAD/B,CACgDC,iBADhD,cACgDA,iBADhD,CACmEC,WADnE,cACmEA,WADnE,CACgFE,kBADhF,cACgFA,kBADhF,CAEH,mBAAQ,2BAAK,SAAS,CAAC,UAAf,CAA0B,KAAK,CAAE,CAAEyB,OAAO,CAAE,MAAX,CAAmBC,QAAQ,CAAE,QAA7B,CAAuCC,QAAQ,CAAE,CAAjD,CAAjC,eACN,2BAAK,KAAK,CAAE,CAAEF,OAAO,CAAE,MAAX,CAAmBC,QAAQ,CAAE,QAA7B,CAAuCC,QAAQ,CAAE,CAAjD,CAAZ,eACE,oBAAC,IAAD,EAAM,KAAK,CAAE7B,WAAb,CAA2B,KAAK,CAAE,OAAlC,CAA2C,QAAQ,CAAE,KAAKb,QAA1D,CAAoE,SAAS,CAAEe,kBAA/E,EADF,CADM,CAAR,CAKL,C,oDAEaH,iB,CAAmBF,Y,CAAc,CAC7C,MAAOE,CAAAA,iBAAiB,CAAC+B,OAAlB,CAA0BjC,YAA1B,GAA2C,CAAlD,CACD,C,4BA5F0Bd,KAAK,CAACgD,S,EA+FnC,cAAe9C,CAAAA,cAAf","sourcesContent":["import React from 'react'\n\nimport './styles.css'\nimport Tree from '@naisutech/react-tree';\n\nclass CurriculumTree extends React.Component {\n\n  constructor(props) {\n    super(props)\n\n\n    this.state = {\n      urlTreeService: document.getElementById('treeservice').textContent,\n      nodeIdToLoad: document.getElementById('treeservice-nodeid').textContent,\n      nodeDepthToLoad: 1,\n      loadedTreeNodeIds: [],\n      nodesOfTree: [],\n      alreadyinTree: [],\n      showLoadingSpinner: 1,\n    }\n\n    this.loadTreeSection(\n      this.state.nodeIdToLoad,\n      this.state.nodeDepthToLoad,\n      this.state.loadedTreeNodeIds,\n      this.state.nodesOfTree,\n      this.state.alreadyinTree)\n  }\n\n  loadTreeSection(nodeIdToLoad,\n                  nodeDepthToLoad,\n                  loadedTreeNodeIds,\n                  nodesOfTree,\n                  alreadyinTree) {\n\n    const params = new URLSearchParams()\n    params.append('node_id', nodeIdToLoad)\n    params.append('node_depth', nodeDepthToLoad)\n\n    fetch(this.state.urlTreeService + \"&\" + params).then(res => res.json())\n    .then(json => {\n      let tree_node\n      for(let i = 0; i < json.length; i++) {\n          tree_node =json[i];\n          console.log(tree_node.id)\n        if(this.checkIfLoaded(alreadyinTree, tree_node.id) === false) {\n          console.log('LOAD')\n          this.state.nodesOfTree.push(tree_node);\n          this.state.alreadyinTree.push(tree_node.id);\n        }\n      }\n\n      this.setState({\n        loadedTreeNodeIds: [...this.state.loadedTreeNodeIds, nodeIdToLoad],\n        nodesOfTree: this.state.nodesOfTree,\n        alreadyinTree: this.state.alreadyinTree,\n       showLoadingSpinner: ''\n      })\n    })\n  }\n\n\n  onSelect = (selectedNode) => {\n    if(selectedNode.type == 'cat') {\n      this.onSelectilCategory(selectedNode)\n    } else {\n      this.onSelectilItem(selectedNode)\n    }\n  }\n\n  onSelectilCategory(selectedCategoryNode) {\n    const { urlTreeService, nodeIdToLoad, nodeDepthToLoad, loadedTreeNodeIds, nodesOfTree, alreadyinTree,showLoadingSpinner } = this.state;\n    if (this.checkIfLoaded(loadedTreeNodeIds, selectedCategoryNode.id) === false) {\n      this.setState({showLoadingSpinner: 1})\n      this.loadTreeSection(\n        selectedCategoryNode.id, selectedCategoryNode.depth, loadedTreeNodeIds, nodesOfTree, alreadyinTree)\n    }\n  }\n\n  onSelectilItem(selectedItemNode) {\n    const { urlTreeService, nodeIdToLoad, nodeDepthToLoad, loadedTreeNodeIds, nodesOfTree, alreadyinTree,showLoadingSpinner } = this.state;\n    console.log(selectedItemNode.link)\n    this.setState({showLoadingSpinner: 1})\n    window.location.href = selectedItemNode.link\n  }\n\n  render() {\n    const { urlTreeService, nodeIdToLoad, nodeDepthToLoad, loadedTreeNodeIds, nodesOfTree, showLoadingSpinner } = this.state;\n        return (<div className=\"showtree\" style={{ display: 'flex', flexWrap: 'nowrap', flexGrow: 1 }}>\n          <div style={{ display: 'flex', flexWrap: 'nowrap', flexGrow: 1}}>\n            <Tree nodes={nodesOfTree}  theme={'light'} onSelect={this.onSelect} isLoading={showLoadingSpinner} />\n          </div>\n        </div>)\n  }\n\n  checkIfLoaded(loadedTreeNodeIds, nodeIdToLoad) {\n    return loadedTreeNodeIds.indexOf(nodeIdToLoad) >= 0\n  }\n}\n\nexport default CurriculumTree;\nCurriculumTree.propTypes = {}"]},"metadata":{},"sourceType":"module"}